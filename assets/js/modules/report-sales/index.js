import{e as C,h as g}from"../chunk-Z5J2ARA6.js";import{a as f,b as F,c as O}from"../chunk-27NF6URH.js";import{e as h,f as y,h as A,n as D,o as p,p as V}from"../chunk-ZVGFYNKE.js";var e=h(y()),H=h(A());var a=h(y());var M=async({vendor:t,customer:l,branch:i,initDate:r,endDate:m})=>{t=t==0?"":t,l=l==0?"":l,i=i==0?"":i;let{data:u}=await p(`/controller/ventas/listar.php?idSucursal=${i}&idVendedor=${t}&idCliente=${l}&fechaInicio=${r}&fechaFin=${m}`);return u},k=async t=>{let{data:l}=await p("/controller/ventas/listar_productos?idVenta="+t);return l},x=async(t,l)=>{let{data:i}=await V("/controller/ventas/eliminar.php",{venta:t,sucursal:l});return i},B=async()=>{let{data:t}=await p("/controller/sucursales/listar.php");return t},I=async t=>{let{data:l}=await p("/controller/usuarios/listar.php?idSucursal="+t);return l},P=async()=>{let{data:t}=await p("/controller/clientes/filtro.php?filter=");return t.data};var U=({onSubmit:t})=>{let[l]=a.useContext(f),[i,r]=a.useState(()=>l.rol==="2"?l.idSucursal:0),[m,u]=a.useState([]),[o,S]=a.useState([]),[b,w]=a.useState([]),R=a.useCallback(async()=>{let n=await B();u(n)},[]),N=a.useCallback(async()=>{if(i){let n=await I(i);w(n)}},[i]),c=a.useCallback(async()=>{let n=await P();S(n)},[]);a.useEffect(()=>{(async()=>(R(),c()))()},[]),a.useEffect(()=>{N()},[N]);let s=D({initialValues:{branch:0,vendor:0,customer:0,initDate:"",endDate:""},onSubmit:t});return a.createElement(a.Fragment,null,a.createElement("form",{onSubmit:s.handleSubmit},a.createElement("div",{className:"mb-3"},l.rol==="1"?a.createElement("select",{name:"branch",id:"idSucursal",value:s.values.branch,onChange:n=>{s.handleChange(n),r(n.target.value)}},a.createElement("option",{value:0}," --- Sucursal ---"),m.map((n,v)=>a.createElement("option",{key:v,value:n.idSucursal},n.sucursal))):null,a.createElement("select",{name:"vendor",id:"idVendedor",value:s.values.salesMan,onChange:s.handleChange},a.createElement("option",{value:0}," --- Vendedor ---"),b.map((n,v)=>a.createElement("option",{key:v,value:n.idUsuario},n.nombre))),a.createElement("select",{name:"customer",id:"idCliente",value:s.values.customer,onChange:s.handleChange},a.createElement("option",{value:""},"--- Cliente ---"),o.map((n,v)=>a.createElement("option",{key:v,value:n.idCliente},n.nombre))),"Fecha Inicio:",a.createElement("input",{type:"date",name:"initDate",id:"",value:s.values.initDate,onChange:s.handleChange}),"Fecha Fin:",a.createElement("input",{type:"date",name:"endDate",id:"",value:s.values.endDate,onChange:s.handleChange})),a.createElement("div",null,a.createElement("button",{type:"submit",className:"btn btn-primary"},"Buscar"))))},T=U;var d=h(y()),$=h(O()),_=({sales:t,onDelete:l,onView:i})=>{let r=[{name:"Vendedor",selector:o=>o.vendedor},{name:"Fecha/Hora",selector:o=>o.fecha},{name:"Monto",selector:o=>o.monto},{name:"Acciones",cell:o=>d.createElement(d.Fragment,null,d.createElement("button",{className:"btn btn-iconbtn btn-sm",onClick:()=>m(o)},d.createElement("i",{className:"fas fa-edit",style:{color:"#278CCD"}})),d.createElement("button",{className:"btn btn-iconbtn btn-sm",onClick:()=>u(o)},d.createElement("i",{className:"fas fa-trash-alt",style:{color:"red"}})))}],m=o=>{i(o)},u=o=>{l(o)};return d.createElement(d.Fragment,null,d.createElement($.default,{columns:r,data:t,pagination:!0}))},E=_;var j=document.getElementById("divContainer"),q=(0,H.createRoot)(j),z=()=>{let[t]=e.useContext(f),[l,i]=e.useState([]),[r,m]=e.useState(null),[u,o]=e.useState(0),[S,b]=e.useState(!1);return e.createElement("div",{className:"row"},e.createElement("div",{className:"card"},e.createElement("div",{className:"card-body"},e.createElement("h5",null,"Reporte de Ventas"),e.createElement("div",{className:"row"},e.createElement("div",{className:"col"},e.createElement("h6",null,"Filtros"),e.createElement(T,{onSubmit:async c=>{let s=await M(c);o(c.branch),i(s)}}))),e.createElement("div",{className:"row"},e.createElement("div",{className:"col"},e.createElement("div",{className:"table-responsive"},e.createElement(E,{sales:l,onDelete:c=>{(async()=>{let s=t.rol==1?u:t.idSucursal,n=await x(c.idVenta,s);i([])})()},onView:c=>{k(c.idVenta).then(s=>{c.products=s,m(c),b(!0)})}})))))),e.createElement("div",null,r?e.createElement(g,{show:S,onHide:()=>{b(!1),m(null)}},e.createElement(g.Body,null,e.createElement("div",{className:"row row-sm"},e.createElement("div",{className:"col-md-12 col-xl-12"},e.createElement("div",{className:" main-content-body-invoice"},e.createElement("div",{className:"card card-invoice"},e.createElement("div",{className:"card-body"},e.createElement("div",{className:"invoice-header"},e.createElement("h1",{className:"invoice-title"},"Nota"),e.createElement("div",{className:"billed-from"},e.createElement("h6",{id:"ventaDireccion"},r.direccion),e.createElement("p",null,e.createElement("br",null),e.createElement("br",null)))),e.createElement("div",{className:"row mg-t-20"},e.createElement("div",{className:"col-md"},e.createElement("label",{className:"tx-gray-600"},"Cliente:"),e.createElement("div",{className:"billed-to"},e.createElement("h6",{id:"clienteDetalle"},r.cliente))),e.createElement("div",{className:"col-md"},e.createElement("label",{className:"tx-gray-600"},"Infomacion de la nota:"),e.createElement("p",{className:"invoice-info-row"},e.createElement("span",null,e.createElement("small",null,"Nota No."))," ",e.createElement("span",null,e.createElement("small",{id:"idDetalle"},r.idVenta.padStart(3,"0")))),e.createElement("p",{className:"invoice-info-row"},e.createElement("span",null,e.createElement("small",null,"Vendedor:"))," ",e.createElement("span",null,e.createElement("small",{id:"vendedorDetalle"},r.vendedor))),e.createElement("p",{className:"invoice-info-row"},e.createElement("span",null,e.createElement("small",null,"Fecha y Hora:"))," ",e.createElement("span",null,e.createElement("small",{id:"fechaDetalle"},r.fecha))))),e.createElement("div",{className:"table-responsive mg-t-40"},e.createElement("table",{id:"tablaProductosDetalle",className:"table table-invoice border text-md-nowrap mb-0"},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null,e.createElement("small",null,"Producto")),e.createElement("th",null,e.createElement("small",null,"Precio")),e.createElement("th",null,e.createElement("small",null,"Cantidad")),e.createElement("th",null,e.createElement("small",null,"Total")))),e.createElement("tbody",null,r.products.map((c,s)=>e.createElement("tr",{key:s},e.createElement("td",null,c.nombre),e.createElement("td",null,c.precio),e.createElement("td",null,c.cantidad),e.createElement("td",null,C(new Number(c.total))))))),e.createElement("h3",{className:"mt-4"},"Total:",e.createElement("span",{id:"totalDetalle"},C(new Number(r.monto))))),e.createElement("a",{href:"#",className:"btn btn-info float-end mt-3 ms-2"},e.createElement("i",{className:"mdi mdi-printer me-1"}),"Imprimir")))))))):null))},G=()=>e.createElement(F,null,e.createElement(z,null));q.render(e.createElement(G,null));
//# sourceMappingURL=index.js.map
